# Maintainer: Bruno Goncalves <bigbruno@gmail.com>
# Contributor: Elppans Dark Elven

pkgname=debtap-mod
pkgver=23.01.28
_pkgver=${pkgver}-1651
pkgrel=1
arch=('any')
license=('GPL')
depends=('yad' 'namcap' 'pamac-gtk' 'zenity' 'fakeroot')
url="https://github.com/biglinux/debtap-mod"
pkgdesc="Convert and install .deb packages"
source=("https://github.com/biglinux/debtap-mod/archive/refs/tags/debtap-mod-${_pkgver}.tar.gz")
sha256sums=("7ca863abbc841d2add501bab7ccfc7d6fd447468b8df9b1b439589d034cc645e")


package() {
# Default Folder
        InternalDir="${srcdir}/${pkgname}-${pkgname}-${_pkgver}"

    # Copy files
    if [ -d "${InternalDir}/usr" ]; then
        cp -r "${InternalDir}/usr" "${pkgdir}/"
    fi

    if [ -d "${InternalDir}/etc" ]; then
        cp -r "${InternalDir}/etc" "${pkgdir}/"
    fi

    if [ -d "${InternalDir}/opt" ]; then
        cp -r "${InternalDir}/opt" "${pkgdir}/"
    fi
    # MIME Files
    mkdir -p "${pkgdir}/usr/share/mime/packages"
    echo -e "<?xml version="1.0"?>
<mime-info xmlns="http://www.freedesktop.org/standards/shared-mime-info">
  <mime-type type="application/vnd.debian.binary-package">
    <comment>Debian Package</comment>
    <sub-class-of type="application/x-deb"/>
    <glob pattern="*.deb"/>
    <icon name="application-x-debian-package"/>
    <generic-icon name="package-x-generic"/>
    <magic priority="50">
      <match type="string" value="!&lt;arch&gt;!&lt;magic&gt;!&lt;archive&gt;debian-binary" offset="0"/>
    </magic>
  </mime-type>
</mime-info>" > "${pkgdir}/usr/share/mime/packages/${pkgname}.xml"
}
